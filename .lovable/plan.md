

## –¶–µ–ª—å
–†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –ø–æ–≤–µ–¥–µ–Ω–∏–µ —Å—Ç–æ—Ä–∏—Å –≤ —á–∞—Ç–∞—Ö **—Ç–æ—á–Ω–æ –∫–∞–∫ –≤ Telegram**:
- –°—Ç–æ—Ä–∏—Å **–∏–∑–Ω–∞—á–∞–ª—å–Ω–æ —Å–≤—ë—Ä–Ω—É—Ç—ã** –≤ –º–∞–ª–µ–Ω—å–∫—É—é —Å—Ç–æ–ø–∫—É –≤ —Ö–µ–¥–µ—Ä–µ (—Ä—è–¥–æ–º —Å –∑–∞–≥–æ–ª–æ–≤–∫–æ–º "–ß–∞—Ç—ã")
- **Pull-down –∂–µ—Å—Ç** –∫–æ–≥–¥–∞ —Å–ø–∏—Å–æ–∫ –Ω–∞ scrollTop=0 —Ä–∞—Å–∫—Ä—ã–≤–∞–µ—Ç —Å—Ç–æ—Ä–∏—Å –≤ –ø–æ–ª–Ω—É—é —Å—Ç—Ä–æ–∫—É
- –ü—Ä–∏ **—Å–∫—Ä–æ–ª–ª–µ –≤–Ω–∏–∑** –∏–ª–∏ –æ—Ç–ø—É—Å–∫–∞–Ω–∏–∏ —Å—Ç–æ—Ä–∏—Å —Å–≤–æ—Ä–∞—á–∏–≤–∞—é—Ç—Å—è –æ–±—Ä–∞—Ç–Ω–æ
- –ü–ª–∞–≤–Ω–∞—è –∞–Ω–∏–º–∞—Ü–∏—è 60fps

---

## –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—ã–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è

### –¢–µ–∫—É—â–∞—è –ø—Ä–æ–±–ª–µ–º–∞
–°–µ–π—á–∞—Å ChatStories –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –≤–Ω—É—Ç—Ä–∏ scroll-–∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞ —Å–æ `sticky top-0`. –≠—Ç–æ –Ω–µ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç Telegram, –≥–¥–µ:
1. –°—Ç–æ–ø–∫–∞ —Å—Ç–æ—Ä–∏—Å **–≤ —Ö–µ–¥–µ—Ä–µ** (—Ä—è–¥–æ–º —Å –∑–∞–≥–æ–ª–æ–≤–∫–æ–º –∏ –∏–∫–æ–Ω–∫–æ–π –ø–æ–∏—Å–∫–∞)
2. –†–∞—Å–∫—Ä—ã—Ç–∏–µ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç —á–µ—Ä–µ–∑ **pull-down overscroll**, –∞ –Ω–µ –æ–±—ã—á–Ω—ã–π —Å–∫—Ä–æ–ª–ª

### –†–µ—à–µ–Ω–∏–µ
–ü–µ—Ä–µ–Ω–µ—Å—Ç–∏ —Å—Ç–æ—Ä–∏—Å –≤ —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã–π —Ö–µ–¥–µ—Ä –∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å pull-down –∂–µ—Å—Ç –¥–ª—è —Ä–∞—Å–∫—Ä—ã—Ç–∏—è.

---

## –ü–ª–∞–Ω –∏–∑–º–µ–Ω–µ–Ω–∏–π

### 1. –°–æ–∑–¥–∞—Ç—å —Ö—É–∫ `usePullDownExpand`
**–§–∞–π–ª:** `src/hooks/usePullDownExpand.tsx` (–Ω–æ–≤—ã–π)

–°–ø–µ—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–π —Ö—É–∫ –¥–ª—è pull-down –∂–µ—Å—Ç–∞, –∫–æ—Ç–æ—Ä—ã–π —Ä–∞–±–æ—Ç–∞–µ—Ç —Ç–æ–ª—å–∫–æ –∫–æ–≥–¥–∞ `scrollTop = 0`:

```text
–õ–æ–≥–∏–∫–∞:
1. –û—Ç—Å–ª–µ–∂–∏–≤–∞—Ç—å touchstart/touchmove/touchend –Ω–∞ scroll-–∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–µ
2. –ï—Å–ª–∏ scrollTop = 0 –∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —Ç—è–Ω–µ—Ç –≤–Ω–∏–∑:
   - –í—ã—á–∏—Å–ª—è—Ç—å progress (0‚Üí1) –Ω–∞ –æ—Å–Ω–æ–≤–µ –¥–∏—Å—Ç–∞–Ω—Ü–∏–∏
   - –ë–ª–æ–∫–∏—Ä–æ–≤–∞—Ç—å –æ–±—ã—á–Ω—ã–π —Å–∫—Ä–æ–ª–ª (preventDefault)
3. –ü—Ä–∏ –æ—Ç–ø—É—Å–∫–∞–Ω–∏–∏:
   - –ï—Å–ª–∏ progress > 0.5 ‚Üí –æ—Å—Ç–∞–≤–∏—Ç—å —Ä–∞—Å–∫—Ä—ã—Ç—ã–º–∏ (expanded = true)
   - –ò–Ω–∞—á–µ ‚Üí —Å–≤–µ—Ä–Ω—É—Ç—å (expanded = false)
4. –ü—Ä–∏ —Å–∫—Ä–æ–ª–ª–µ –≤–Ω–∏–∑ (scrollTop > 0) ‚Üí –ø—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ —Å–≤–µ—Ä–Ω—É—Ç—å
```

### 2. –û–±–Ω–æ–≤–∏—Ç—å `ChatsPage.tsx`
**–§–∞–π–ª:** `src/pages/ChatsPage.tsx`

–ò–∑–º–µ–Ω–µ–Ω–∏—è:
- –ò–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞—Ç—å —Å—Ç–æ—Ä–∏—Å –≤ —Ö–µ–¥–µ—Ä (–Ω–µ –≤ scroll-–æ–±–ª–∞—Å—Ç—å)
- –•–µ–¥–µ—Ä —Å—Ç–∞–Ω–æ–≤–∏—Ç—Å—è –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–º –ø–æ –≤—ã—Å–æ—Ç–µ:
  - –°–≤—ë—Ä–Ω—É—Ç—ã–π: ~56px (–∑–∞–≥–æ–ª–æ–≤–æ–∫ + —Å—Ç–æ–ø–∫–∞ –∞–≤–∞—Ç–∞—Ä–æ–≤)
  - –†–∞—Å–∫—Ä—ã—Ç—ã–π: ~120px (–ø–æ–ª–Ω–∞—è —Å—Ç—Ä–æ–∫–∞ —Å—Ç–æ—Ä–∏—Å)
- –ü–æ–¥–∫–ª—é—á–∏—Ç—å —Ö—É–∫ `usePullDownExpand`

```text
–°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ö–µ–¥–µ—Ä–∞:
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ  [—Å—Ç–æ–ø–∫–∞]  "–ß–∞—Ç—ã"           [üîç –ø–æ–∏—Å–∫]          ‚îÇ ‚Üê —Å–≤—ë—Ä–Ω—É—Ç—ã–π
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò

‚Üì pull-down

‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ              "–ß–∞—Ç—ã"                [üîç]         ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ  [üë§][üë§][üë§][üë§][üë§]...                        ‚îÇ ‚Üê —Ä–∞—Å–∫—Ä—ã—Ç—ã–π
‚îÇ  –í—ã  –ò–º—è –ò–º—è –ò–º—è ...                            ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

### 3. –û–±–Ω–æ–≤–∏—Ç—å `ChatStories.tsx`
**–§–∞–π–ª:** `src/components/chat/ChatStories.tsx`

–ò–∑–º–µ–Ω–µ–Ω–∏—è:
- –ü—Ä–∏–Ω–∏–º–∞—Ç—å `expandProgress` —á–µ—Ä–µ–∑ –ø—Ä–æ–ø—Å—ã (–≤–º–µ—Å—Ç–æ —Ö—É–∫–∞ `useScrollCollapse`)
- –ü–µ—Ä–µ–∏–º–µ–Ω–æ–≤–∞—Ç—å –ª–æ–≥–∏–∫—É: `collapseProgress` ‚Üí `expandProgress` (–∏–Ω–≤–µ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å)
- –£–±—Ä–∞—Ç—å sticky –ø–æ–∑–∏—Ü–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ
- –í —Å–≤—ë—Ä–Ω—É—Ç–æ–º —Å–æ—Å—Ç–æ—è–Ω–∏–∏ —Ä–µ–Ω–¥–µ—Ä–∏—Ç—å —Ç–æ–ª—å–∫–æ —Å—Ç–æ–ø–∫—É (–±–µ–∑ –∏–º—ë–Ω)

–ö–æ–Ω—Å—Ç–∞–Ω—Ç—ã:
```text
COLLAPSED: —Å—Ç–æ–ø–∫–∞ 32px –∞–≤–∞—Ç–∞—Ä–æ–≤ —Å overlap 10px, –º–∞–∫—Å 4 –≤–∏–¥–∏–º—ã—Ö
EXPANDED: —Å—Ç—Ä–æ–∫–∞ 64px –∞–≤–∞—Ç–∞—Ä–æ–≤ —Å gap 16px, —Å –∏–º–µ–Ω–∞–º–∏
```

---

## –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –¥–µ—Ç–∞–ª–∏

### usePullDownExpand —Ö—É–∫

```text
interface PullDownExpandState {
  expandProgress: number;    // 0 = —Å–≤—ë—Ä–Ω—É—Ç–æ, 1 = —Ä–∞—Å–∫—Ä—ã—Ç–æ
  isExpanded: boolean;       // true –µ—Å–ª–∏ –∑–∞—Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–æ –≤ —Ä–∞—Å–∫—Ä—ã—Ç–æ–º —Å–æ—Å—Ç–æ—è–Ω–∏–∏
  isDragging: boolean;       // true –≤–æ –≤—Ä–µ–º—è –∂–µ—Å—Ç–∞
}

–¢—Ä–∏–≥–≥–µ—Ä—ã:
- Pull-down (scrollTop=0): —É–≤–µ–ª–∏—á–∏–≤–∞–µ—Ç progress
- –û—Ç–ø—É—Å–∫–∞–Ω–∏–µ –ø—Ä–∏ progress > 0.5: —Ñ–∏–∫—Å–∏—Ä—É–µ—Ç expanded=true
- –°–∫—Ä–æ–ª–ª –≤–Ω–∏–∑ (scrollTop > threshold): —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç expanded=false
- Tap –Ω–∞ —Å–≤—ë—Ä–Ω—É—Ç—É—é —Å—Ç–æ–ø–∫—É: toggles expanded
```

### –ê–Ω–∏–º–∞—Ü–∏—è –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞

```text
Header height animation:
- Collapsed: 56px
- Expanded: 56px + 88px (row height) = 144px

–ò—Å–ø–æ–ª—å–∑—É–µ–º transform/height —Å will-change –¥–ª—è 60fps.
```

### –ü–æ–∑–∏—Ü–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ —Å—Ç–æ–ø–∫–∏ –≤ —Ö–µ–¥–µ—Ä–µ

```text
–°–≤—ë—Ä–Ω—É—Ç–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ:
- –°—Ç–æ–ø–∫–∞ —Å–ª–µ–≤–∞ –æ—Ç –∑–∞–≥–æ–ª–æ–≤–∫–∞ "–ß–∞—Ç—ã"
- –ê–≤–∞—Ç–∞—Ä—ã 32px —Å overlap
- –ó–∞–≥–æ–ª–æ–≤–æ–∫ —Ü–µ–Ω—Ç—Ä–∏—Ä–æ–≤–∞–Ω –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω–æ –æ—Å—Ç–∞–≤—à–µ–≥–æ—Å—è –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–∞

–†–∞—Å–∫—Ä—ã—Ç–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ:
- –ó–∞–≥–æ–ª–æ–≤–æ–∫ –∏ –ø–æ–∏—Å–∫ –≤ –ø–µ—Ä–≤–æ–π —Å—Ç—Ä–æ–∫–µ
- –°—Ç–æ—Ä–∏—Å –≤–æ –≤—Ç–æ—Ä–æ–π —Å—Ç—Ä–æ–∫–µ –ø–æ–¥ –∑–∞–≥–æ–ª–æ–≤–∫–æ–º
```

---

## –†–µ–∑—É–ª—å—Ç–∞—Ç

- –°—Ç–æ—Ä–∏—Å **—Ä–µ–Ω–¥–µ—Ä—è—Ç—Å—è —Å–≤—ë—Ä–Ω—É—Ç—ã–º–∏** –≤ —Ö–µ–¥–µ—Ä–µ –∫–∞–∫ —Å—Ç–æ–ø–∫–∞ (–∫–∞–∫ –≤ Telegram)
- **Pull-down –∂–µ—Å—Ç** –ø–ª–∞–≤–Ω–æ —Ä–∞—Å–∫—Ä—ã–≤–∞–µ—Ç –∏—Ö –≤ –ø–æ–ª–Ω—É—é —Å—Ç—Ä–æ–∫—É
- **–°–∫—Ä–æ–ª–ª –≤–Ω–∏–∑** –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–≤–æ—Ä–∞—á–∏–≤–∞–µ—Ç –æ–±—Ä–∞—Ç–Ω–æ
- **Tap –Ω–∞ —Å—Ç–æ–ø–∫—É** —Ç–æ–∂–µ —Ä–∞—Å–∫—Ä—ã–≤–∞–µ—Ç/–æ—Ç–∫—Ä—ã–≤–∞–µ—Ç —Å—Ç–æ—Ä–∏—Å
- –ù–∏–∫–∞–∫–æ–≥–æ –ø—É—Å—Ç–æ–≥–æ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–∞ –≤ —Å–ø–∏—Å–∫–µ —á–∞—Ç–æ–≤
- 60fps –∞–Ω–∏–º–∞—Ü–∏—è –Ω–∞ –≤—Å–µ—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞—Ö

