

# –ü–ª–∞–Ω: –†–∞—Å—à–∏—Ä–µ–Ω–Ω–∞—è –ø–∞–Ω–µ–ª—å —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–∞ + –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –≤–∏–¥–µ–æ–∑–≤–æ–Ω–∫–æ–≤

## –û–±–∑–æ—Ä

–°–æ–∑–¥–∞—ë–º –ø–æ–ª–Ω–æ—Ü–µ–Ω–Ω—É—é –ø–∞–Ω–µ–ª—å —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–∞ —Å:
1. –û—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ–º –∏–∑–≤–µ—Å—Ç–Ω—ã—Ö –±–∞–≥–æ–≤ –∏ –∏—Ö —Å—Ç–∞—Ç—É—Å–∞
2. –°–ø–∏—Å–∫–æ–º –∑–∞–¥–∞—á –ø–æ —ç—Ç–∞–ø–∞–º —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏
3. –£–ª—É—á—à–µ–Ω–Ω–æ–π –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–æ–π –∑–≤–æ–Ω–∫–æ–≤
4. –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ–º –≥–ª–∞–≤–Ω–æ–≥–æ –±–∞–≥–∞ –≤–∏–¥–µ–æ–∑–≤–æ–Ω–∫–æ–≤

---

## –ê–Ω–∞–ª–∏–∑ –≥–ª–∞–≤–Ω–æ–≥–æ –±–∞–≥–∞: –í–∏–¥–µ–æ–∑–≤–æ–Ω–∫–∏

**–§–∞–∫—Ç—ã –∏–∑ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö:**
- –ü–æ—Å–ª–µ–¥–Ω–∏–µ 6 –≤–∏–¥–µ–æ–∑–≤–æ–Ω–∫–æ–≤: –≤—Å–µ –∏–º–µ—é—Ç `started_at: null` (–ù–ï —Å–æ–µ–¥–∏–Ω–∏–ª–∏—Å—å)
- –ê—É–¥–∏–æ–∑–≤–æ–Ω–æ–∫ `cd44b1fe-092f-40e4-ba4e-6c182e292754`: `started_at: 2026-02-02 20:42:26` (–°–û–ï–î–ò–ù–ò–õ–°–Ø)
- Debug-—Å–∏–≥–Ω–∞–ª—ã: –ø—É—Å—Ç—ã–µ (–∫–æ–¥ –Ω–µ –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è –∏–ª–∏ –Ω–µ –¥–æ—Ö–æ–¥–∏—Ç –¥–æ –ë–î)

**–ì–∏–ø–æ—Ç–µ–∑–∞:**
–ü—Ä–∏ –æ—Ç–≤–µ—Ç–µ –Ω–∞ –≤–∏–¥–µ–æ–∑–≤–æ–Ω–æ–∫ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç —Å–±–æ–π –î–û –æ—Ç–ø—Ä–∞–≤–∫–∏ debug-—Å–æ–±—ã—Ç–∏—è ‚Äî —Å–∫–æ—Ä–µ–µ –≤—Å–µ–≥–æ –Ω–∞ —ç—Ç–∞–ø–µ `getUserMedia` –¥–ª—è –≤–∏–¥–µ–æ.

---

## –≠—Ç–∞–ø 1: –†–∞—Å—à–∏—Ä–∏—Ç—å –ø–∞–Ω–µ–ª—å —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–∞

### 1.1 –î–æ–±–∞–≤–∏—Ç—å –≤–∫–ª–∞–¥–∫—É "–ë–∞–≥–∏" (Known Issues)

–•–∞—Ä–¥–∫–æ–¥–∏–º –∏–∑–≤–µ—Å—Ç–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã —Å –∏—Ö —Å—Ç–∞—Ç—É—Å–∞–º–∏:

| ID | –ü—Ä–æ–±–ª–µ–º–∞ | –°—Ç–∞—Ç—É—Å | –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç |
|----|----------|--------|-----------|
| BUG-001 | –í–∏–¥–µ–æ–∑–≤–æ–Ω–∫–∏ –Ω–µ —Å–æ–µ–¥–∏–Ω—è—é—Ç—Å—è | üî¥ –ê–∫—Ç–∏–≤–Ω—ã–π | –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–π |
| BUG-002 | –°–µ—Å—Å–∏—è –º–æ–∂–µ—Ç —Å–ª–µ—Ç–∞—Ç—å –≤ Telegram iOS | üü° –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ | –í—ã—Å–æ–∫–∏–π |
| BUG-003 | ICE candidates –º–æ–≥—É—Ç –Ω–µ –¥–æ—Ö–æ–¥–∏—Ç—å | üü¢ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–æ | –°—Ä–µ–¥–Ω–∏–π |

### 1.2 –î–æ–±–∞–≤–∏—Ç—å –≤–∫–ª–∞–¥–∫—É "–ó–∞–¥–∞—á–∏" (Roadmap)

–≠—Ç–∞–ø—ã —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏:

```text
–§–∞–∑–∞ 1: –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è
‚îú‚îÄ‚îÄ [üî¥] –ò—Å–ø—Ä–∞–≤–∏—Ç—å –≤–∏–¥–µ–æ–∑–≤–æ–Ω–∫–∏
‚îú‚îÄ‚îÄ [‚úÖ] –î–æ–±–∞–≤–∏—Ç—å —Å–µ—Ä–≤–µ—Ä–Ω—É—é –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫—É
‚îî‚îÄ‚îÄ [‚úÖ] –°–æ–∑–¥–∞—Ç—å –ø–∞–Ω–µ–ª—å —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–∞

–§–∞–∑–∞ 2: –°—Ç–∞–±–∏–ª–∏–∑–∞—Ü–∏—è
‚îú‚îÄ‚îÄ [‚è≥] Push-—É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –¥–ª—è –∑–≤–æ–Ω–∫–æ–≤
‚îú‚îÄ‚îÄ [‚è≥] –û—Ñ—Ñ–ª–∞–π–Ω-—Ä–µ–∂–∏–º —Å –æ—á–µ—Ä–µ–¥—å—é —Å–æ–æ–±—â–µ–Ω–∏–π
‚îî‚îÄ‚îÄ [‚è≥] –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –±–∞—Ç–∞—Ä–µ–∏

–§–∞–∑–∞ 3: –ù–æ–≤—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏
‚îú‚îÄ‚îÄ [‚è≥] –ì—Ä—É–ø–ø–æ–≤—ã–µ –≤–∏–¥–µ–æ–∑–≤–æ–Ω–∫–∏
‚îú‚îÄ‚îÄ [‚è≥] –î–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏—è —ç–∫—Ä–∞–Ω–∞
‚îî‚îÄ‚îÄ [‚è≥] –ó–∞–ø–∏—Å—å –∑–≤–æ–Ω–∫–æ–≤
```

### 1.3 –î–æ–±–∞–≤–∏—Ç—å —Å–µ–∫—Ü–∏—é "–î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ ICE"

–ü–æ–∫–∞–∑—ã–≤–∞—Ç—å:
- –ü–æ—Å–ª–µ–¥–Ω–∏–π —É—Å–ø–µ—à–Ω—ã–π ICE —Å–µ—Ä–≤–µ—Ä
- –ó–∞–¥–µ—Ä–∂–∫–∞ –¥–æ TURN
- Policy (relay/all)

### 1.4 –î–æ–±–∞–≤–∏—Ç—å –∞–≤—Ç–æ-–æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö

Realtime –ø–æ–¥–ø–∏—Å–∫–∞ –Ω–∞ –Ω–æ–≤—ã–µ debug-—Å–æ–±—ã—Ç–∏—è

---

## –≠—Ç–∞–ø 2: –ò—Å–ø—Ä–∞–≤–∏—Ç—å –≤–∏–¥–µ–æ–∑–≤–æ–Ω–∫–∏

### 2.1 –ü—Ä–æ–±–ª–µ–º–∞: getUserMedia –ø–∞–¥–∞–µ—Ç –º–æ–ª—á–∞

Debug-—Å–æ–±—ã—Ç–∏–µ –¥–æ–ª–∂–Ω–æ –æ—Ç–ø—Ä–∞–≤–ª—è—Ç—å—Å—è –ü–ï–†–ï–î `getUserMedia`, –Ω–æ –ø–æ—Å–ª–µ –≤—Ö–æ–¥–∞ –≤ —Ñ—É–Ω–∫—Ü–∏—é. –°–µ–π—á–∞—Å —Å–æ–±—ã—Ç–∏–µ `answer_getusermedia_request` –Ω–µ –ø–æ–ø–∞–¥–∞–µ—Ç –≤ –ë–î ‚Äî –∑–Ω–∞—á–∏—Ç —Ñ—É–Ω–∫—Ü–∏—è `debugEvent` –ª–∏–±–æ –Ω–µ –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è, –ª–∏–±–æ –ø–∞–¥–∞–µ—Ç.

### 2.2 –†–µ—à–µ–Ω–∏–µ: –†–∞–Ω–Ω—è—è –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞

–î–æ–±–∞–≤–∏—Ç—å debug-—Å–æ–±—ã—Ç–∏–µ –°–†–ê–ó–£ –ø—Ä–∏ –≤—Ö–æ–¥–µ –≤ `answerCall`:

```typescript
// –í —Å–∞–º–æ–º –Ω–∞—á–∞–ª–µ answerCall, –ü–ï–†–ï–î –ª—é–±—ã–º–∏ await
const debugEarly = async () => {
  await supabase.from("video_call_signals").insert({
    call_id: call.id,
    sender_id: user?.id ?? "anon",
    signal_type: "debug",
    signal_data: { 
      stage: "answer_entered", 
      ts: new Date().toISOString(),
      callType: call.call_type,
      userAgent: navigator.userAgent,
    }
  });
};
debugEarly(); // –ù–µ –∂–¥—ë–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç
```

### 2.3 –£–ª—É—á—à–∏—Ç—å fallback –¥–ª—è –≤–∏–¥–µ–æ

–ï—Å–ª–∏ –∫–∞–º–µ—Ä–∞ –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–∞, –ø—Ä–æ–±–æ–≤–∞—Ç—å:
1. –¢–æ–ª—å–∫–æ —Ñ—Ä–æ–Ω—Ç–∞–ª—å–Ω—É—é –∫–∞–º–µ—Ä—É
2. –¢–æ–ª—å–∫–æ –∑–∞–¥–Ω —é—é –∫–∞–º–µ—Ä—É
3. –¢–æ–ª—å–∫–æ –∞—É–¥–∏–æ

### 2.4 –î–æ–±–∞–≤–∏—Ç—å —Ç–∞–π–º–∞—É—Ç –Ω–∞ getUserMedia

```typescript
const stream = await Promise.race([
  navigator.mediaDevices.getUserMedia(constraints),
  new Promise((_, reject) => 
    setTimeout(() => reject(new Error("getUserMedia timeout")), 10000)
  )
]);
```

---

## –≠—Ç–∞–ø 3: –£–ª—É—á—à–∏—Ç—å UI –ø–∞–Ω–µ–ª–∏

### 3.1 –ù–æ–≤–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –≤–∫–ª–∞–¥–æ–∫

```text
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ  [üêõ –ë–∞–≥–∏] [üìã –ó–∞–¥–∞—á–∏] [üìû –ó–≤–æ–Ω–∫–∏] [üìä Debug] [üë• –Æ–∑–µ—Ä—ã]
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ                                         ‚îÇ
‚îÇ  –ö–æ–Ω—Ç–µ–Ω—Ç –≤–∫–ª–∞–¥–∫–∏                        ‚îÇ
‚îÇ                                         ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

### 3.2 –í–∫–ª–∞–¥–∫–∞ "–ë–∞–≥–∏"

- –°–ø–∏—Å–æ–∫ –∏–∑–≤–µ—Å—Ç–Ω—ã—Ö –ø—Ä–æ–±–ª–µ–º —Å —Ü–≤–µ—Ç–æ–≤–æ–π –∏–Ω–¥–∏–∫–∞—Ü–∏–µ–π
- –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –¥–æ–±–∞–≤–ª—è—Ç—å –∑–∞–º–µ—Ç–∫–∏
- –°–≤—è–∑—å —Å –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–º–∏ –∑–≤–æ–Ω–∫–∞–º–∏/—Å–æ–±—ã—Ç–∏—è–º–∏

### 3.3 –í–∫–ª–∞–¥–∫–∞ "–ó–∞–¥–∞—á–∏"

- –î—Ä–µ–≤–æ–≤–∏–¥–Ω–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ —ç—Ç–∞–ø–æ–≤
- –ü—Ä–æ–≥—Ä–µ—Å—Å –ø–æ –∫–∞–∂–¥–æ–π —Ñ–∞–∑–µ
- –ß–µ–∫–±–æ–∫—Å—ã –¥–ª—è –æ—Ç–º–µ—Ç–∫–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è

### 3.4 –î–æ–±–∞–≤–∏—Ç—å —Ñ–∏–ª—å—Ç—Ä—ã –¥–ª—è –∑–≤–æ–Ω–∫–æ–≤

- –¢–æ–ª—å–∫–æ –Ω–µ—É–¥–∞—á–Ω—ã–µ
- –¢–æ–ª—å–∫–æ –≤–∏–¥–µ–æ
- –ü–æ –¥–∞—Ç–µ

---

## –§–∞–π–ª—ã –¥–ª—è –∏–∑–º–µ–Ω–µ–Ω–∏—è

| –§–∞–π–ª | –ò–∑–º–µ–Ω–µ–Ω–∏—è |
|------|-----------|
| `src/pages/DevPanelPage.tsx` | –î–æ–±–∞–≤–∏—Ç—å –≤–∫–ª–∞–¥–∫–∏ –ë–∞–≥–∏/–ó–∞–¥–∞—á–∏, —É–ª—É—á—à–∏—Ç—å UI |
| `src/hooks/useVideoCall.ts` | –†–∞–Ω–Ω—è—è –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞, —Ç–∞–π–º–∞—É—Ç getUserMedia |

---

## –î–µ—Ç–∞–ª–∏ —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–æ–π —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏

### DevPanelPage.tsx ‚Äî –ù–æ–≤—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã

```typescript
// –ò–Ω—Ç–µ—Ä—Ñ–µ–π—Å –¥–ª—è –±–∞–≥–æ–≤
interface KnownBug {
  id: string;
  title: string;
  description: string;
  status: "active" | "monitoring" | "fixed";
  priority: "critical" | "high" | "medium" | "low";
  relatedCallIds?: string[];
}

// –ò–Ω—Ç–µ—Ä—Ñ–µ–π—Å –¥–ª—è –∑–∞–¥–∞—á
interface RoadmapTask {
  id: string;
  title: string;
  phase: number;
  status: "todo" | "in_progress" | "done";
  children?: RoadmapTask[];
}
```

### useVideoCall.ts ‚Äî –†–∞–Ω–Ω—è—è –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞

–î–æ–±–∞–≤–∏—Ç—å –≤—ã–∑–æ–≤ –≤ —Å–∞–º–æ–µ –Ω–∞—á–∞–ª–æ `answerCall`:

```typescript
const answerCall = useCallback(async (call: VideoCall) => {
  // –ü–ï–†–í–û–ï –¥–µ–π—Å—Ç–≤–∏–µ ‚Äî –æ—Ç–ø—Ä–∞–≤–∏—Ç—å debug-—Å–æ–±—ã—Ç–∏–µ —Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ (–Ω–µ –∂–¥—ë–º)
  supabase.from("video_call_signals").insert({
    call_id: call.id,
    sender_id: user?.id ?? "unknown",
    signal_type: "debug",
    signal_data: { 
      stage: "answer_fn_entered", 
      ts: new Date().toISOString(),
      callType: call.call_type,
      platform: navigator.platform,
      ua: navigator.userAgent.slice(0, 100),
    }
  }).then(() => {}).catch(() => {});
  
  // –î–∞–ª–µ–µ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–π –∫–æ–¥...
```

---

## –û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç

–ü–æ—Å–ª–µ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏:

1. **–ü–∞–Ω–µ–ª—å —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–∞** –ø–æ–∫–∞–∂–µ—Ç:
   - –í—Å–µ –∏–∑–≤–µ—Å—Ç–Ω—ã–µ –±–∞–≥–∏ —Å –∏—Ö —Å—Ç–∞—Ç—É—Å–æ–º
   - –ü–ª–∞–Ω —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏ –ø–æ —ç—Ç–∞–ø–∞–º
   - –î–µ—Ç–∞–ª—å–Ω—É—é –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫—É –∫–∞–∂–¥–æ–≥–æ –∑–≤–æ–Ω–∫–∞

2. **–í–∏–¥–µ–æ–∑–≤–æ–Ω–∫–∏** –±—É–¥—É—Ç:
   - –õ–æ–≥–∏—Ä–æ–≤–∞—Ç—å –∫–∞–∂–¥—ã–π —à–∞–≥ –≤ –ë–î
   - –ò–º–µ—Ç—å —Ç–∞–π–º–∞—É—Ç –Ω–∞ –ø–æ–ª—É—á–µ–Ω–∏–µ –º–µ–¥–∏–∞
   - –î–µ–ª–∞—Ç—å fallback –Ω–∞ –∞—É–¥–∏–æ –ø—Ä–∏ –ø—Ä–æ–±–ª–µ–º–∞—Ö —Å –∫–∞–º–µ—Ä–æ–π

3. **–û—Ç–ª–∞–¥–∫–∞ —Å—Ç–∞–Ω–µ—Ç –ø—Ä–æ—â–µ**:
   - –í–∏–¥–Ω–æ –≥–¥–µ –∏–º–µ–Ω–Ω–æ –ø–∞–¥–∞–µ—Ç –∑–≤–æ–Ω–æ–∫
   - –ú–æ–∂–Ω–æ –æ—Ç—Å–ª–µ–∂–∏–≤–∞—Ç—å –ø—Ä–æ–≥—Ä–µ—Å—Å –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–π
   - –ß—ë—Ç–∫–∏–π —Ä–æ–∞–¥–º–∞–ø –∑–∞–¥–∞—á

